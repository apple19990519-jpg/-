<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>雪梨十日慢活助手</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #F8FAFC; margin: 0; -webkit-tap-highlight-color: transparent; }
        .header-gradient { background: linear-gradient(135deg, #0c4a6e 0%, #075985 100%); padding-top: env(safe-area-inset-top); }
        .card { background: white; border-radius: 20px; padding: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); margin-bottom: 12px; border: 1px solid #f1f5f9; }
        .day-btn { transition: all 0.2s; flex-shrink: 0; }
        .day-btn.active { background: white; color: #0c4a6e; transform: scale(1.1); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .nav-active { color: #00AEEF; }
        .nav-inactive { color: #cbd5e1; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .kkday-btn { background: #00AEEF; color: white; padding: 8px 12px; border-radius: 10px; font-size: 12px; font-weight: bold; display: inline-flex; items-center: center; gap: 5px; }
        .car-btn { background: #059669; color: white; padding: 8px 12px; border-radius: 10px; font-size: 12px; font-weight: bold; display: inline-flex; items-center: center; gap: 5px; }
        .transport-tag { background: #f1f5f9; color: #475569; padding: 4px 10px; border-radius: 8px; font-size: 12px; font-weight: bold; margin-bottom: 10px; display: inline-block; }
    </style>
</head>
<body class="text-slate-800">

    <div class="max-w-md mx-auto min-h-screen flex flex-col pb-24">
        <!-- Header -->
        <header class="header-gradient text-white rounded-b-[30px] shadow-xl sticky top-0 z-50">
            <div class="px-6 pt-10 pb-6">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h1 id="ui-day-label" class="text-2xl font-black">Day 1</h1>
                        <p id="ui-day-title" class="text-sky-200 text-xs font-bold mt-1">抵達雪梨</p>
                    </div>
                    <div class="bg-white/10 px-3 py-1 rounded-xl border border-white/20 text-center">
                        <span class="text-[10px] block opacity-70">1 AUD ≈ 21.2</span>
                    </div>
                </div>
                <div id="day-scroller" class="flex gap-3 overflow-x-auto hide-scrollbar"></div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="px-5 mt-6 flex-grow">
            <!-- 行程 View -->
            <div id="view-trip">
                <div id="booking-links" class="flex gap-2 mb-4 overflow-x-auto hide-scrollbar">
                    <!-- 動態插入預訂連結 -->
                </div>

                <div class="mb-2">
                    <div id="transport-display"></div>
                </div>
                
                <div id="itinerary-list" class="space-y-3"></div>

                <div class="mt-8 mb-4">
                    <h2 class="text-lg font-black flex items-center gap-2">
                        <i class="fa-solid fa-lightbulb text-yellow-500"></i> 在地導遊建議
                    </h2>
                </div>
                <div id="expert-tips" class="card leading-relaxed text-sm text-slate-600"></div>
            </div>

            <!-- 記帳 View -->
            <div id="view-wallet" class="hidden">
                <div class="card bg-slate-900 text-white py-6 flex justify-between items-end shadow-xl">
                    <div>
                        <p class="text-[10px] font-bold opacity-40 uppercase">總支出 (TWD)</p>
                        <h2 id="total-twd" class="text-3xl font-black mt-1">$ 0</h2>
                    </div>
                    <div class="text-right">
                        <p class="text-[10px] opacity-40 uppercase">AUD 澳幣</p>
                        <p id="total-aud" class="font-bold text-sky-400">$ 0</p>
                    </div>
                </div>
                <div class="card">
                    <div class="space-y-3">
                        <input type="text" id="exp-name" placeholder="項目名稱" class="w-full bg-slate-50 p-3 rounded-xl text-sm outline-none border border-slate-100 focus:border-sky-300">
                        <div class="flex gap-2">
                            <input type="number" id="exp-aud" placeholder="金額 (AUD)" class="flex-1 bg-slate-50 p-3 rounded-xl text-sm outline-none border border-slate-100 focus:border-sky-300">
                            <button onclick="saveExpense()" class="bg-sky-600 text-white px-6 rounded-xl font-bold">儲存</button>
                        </div>
                    </div>
                </div>
                <div id="expense-list" class="space-y-2"></div>
            </div>
        </main>

        <!-- Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-slate-100 py-3 px-10 z-50 flex justify-around shadow-lg">
            <button onclick="switchTab('trip')" id="nav-trip" class="nav-active flex flex-col items-center gap-1">
                <i class="fa-solid fa-route text-xl"></i>
                <span class="text-[10px] font-bold">行程規劃</span>
            </button>
            <button onclick="switchTab('wallet')" id="nav-wallet" class="nav-inactive flex flex-col items-center gap-1">
                <i class="fa-solid fa-receipt text-xl"></i>
                <span class="text-[10px] font-bold">記帳本</span>
            </button>
        </nav>
    </div>

    <script>
        const rate = 21.2;
        let dayIdx = 0;
        let expenses = JSON.parse(localStorage.getItem('sydney_trip_data')) || [];

        const tripData = [
            { 
                d: 1, t: "抵達雪梨與唐人街", 
                s: ["雪梨機場 (SYD)", "市中心飯店", "唐人街慶祝晚餐"],
                trans: "預約包車接機 (最輕鬆)",
                links: [
                    { name: "機場接送預約", url: "https://www.kkday.com/zh-tw/product/23304", icon: "fa-car" }
                ],
                tips: "<b>在地建議：</b>第一天建議直接預約私人接機。雪梨唐人街美食選擇多且有華語服務，對長輩來說最親切。推薦『金唐』系列的粵菜。"
            },
            { 
                d: 2, t: "歌劇院與植物園", 
                s: ["歌劇院內部導覽", "皇家植物園", "麥覺理夫人角"],
                trans: "市區漫步",
                links: [
                    { name: "歌劇院中文導覽", url: "https://www.kkday.com/zh-tw/product/3894", icon: "fa-ticket" }
                ],
                tips: "<b>在地建議：</b>歌劇院內部導覽建議先預訂中文時段。皇家植物園有無障礙步道，傍晚拍照最美。如果長輩走累了，園內有觀光小火車。"
            },
            { 
                d: 3, t: "邦代海灘與雪梨塔", 
                s: ["Bondi Beach", "網美泳池拍照", "雪梨塔晚餐"],
                trans: "公車 333 / Uber",
                links: [
                    { name: "雪梨塔自助餐券", url: "https://www.kkday.com/zh-tw/product/6421", icon: "fa-utensils" }
                ],
                tips: "<b>在地建議：</b>333號公車是低底盤，適合長輩。雪梨塔旋轉餐廳可以看全景，適合帶長輩輕鬆吃飯，不用一直走路找餐廳。"
            },
            { 
                d: 4, t: "塔龍加動物園", 
                s: ["渡輪體驗", "動物園探索", "環形碼頭"],
                trans: "F2 渡輪",
                links: [
                    { name: "動物園門票", url: "https://www.kkday.com/zh-tw/product/6011", icon: "fa-ticket" }
                ],
                tips: "<b>在地建議：</b>進園後先搭纜車到山頂，再順著坡度『往下逛』回碼頭。這樣完全不用爬山，長輩體力負擔最小。"
            },
            { 
                d: 5, t: "百年百貨 QVB", 
                s: ["QVB 百貨購物", "皮特街 Pitt St", "海德公園"],
                trans: "輕軌 L1/L2",
                links: [],
                tips: "<b>在地建議：</b>QVB 是全世界最美商場，有無障礙電梯。二樓有很棒的英式下午茶，逛街累了可以休息一下。"
            },
            { 
                d: 6, t: "藍山國家公園", 
                s: ["景觀纜車", "三姐妹岩", "盧拉小鎮"],
                trans: "包車或一日遊團",
                links: [
                    { name: "藍山一日遊(包車)", url: "https://www.kkday.com/zh-tw/product/140640", icon: "fa-bus" },
                    { name: "藍山纜車套票", url: "https://www.kkday.com/zh-tw/product/6045", icon: "fa-ticket" }
                ],
                tips: "<b>在地建議：</b>藍山建議直接參加 KKday 一日遊或包車，長輩不用轉火車。山上風大，記得帶件外套防寒。"
            },
            { 
                d: 7, t: "週末岩石區市集", 
                s: ["岩石區市集", "跨海大橋步道", "港灣咖啡"],
                trans: "火車/輕軌",
                links: [],
                tips: "<b>在地建議：</b>市集有很多手工工藝品。這區地板是舊石磚，比較不平，請長輩慢走。港灣大橋有電梯可以上去看風景。"
            },
            { 
                d: 8, t: "魚市場與情人港", 
                s: ["魚市場海鮮", "情人港散步", "巴蘭加魯"],
                trans: "輕軌 L1",
                links: [],
                tips: "<b>在地建議：</b>魚市場建議早上去吃生蠔。情人港（達令港）區有無障礙木棧道，晚上吹海風看風景非常愜意。"
            },
            { 
                d: 9, t: "超市伴手禮採買", 
                s: ["Paddy's Market", "Woolworths 超市", "告別晚餐"],
                trans: "Uber / 步行",
                links: [],
                tips: "<b>在地建議：</b>今天採買澳洲神仙水、木瓜霜等伴手禮。超市買 Tim Tam 巧克力最便宜，可以直接用信用卡感應結帳。"
            },
            { 
                d: 10, t: "退稅與歸途", 
                s: ["飯店退房", "機場 TRS 退稅", "歸途"],
                trans: "預約送機包車",
                links: [
                    { name: "送機包車預約", url: "https://www.kkday.com/zh-tw/product/23304", icon: "fa-car" }
                ],
                tips: "<b>在地建議：</b>退稅要預留至少 1.5 小時，收據準備好。TRS App 先填好可以加速。建議直接包車到機場，行李重也不擔心。"
            }
        ];

        function init() {
            renderDayBar();
            updateView();
            renderExpenses();
        }

        function switchTab(t) {
            document.getElementById('view-trip').classList.toggle('hidden', t !== 'trip');
            document.getElementById('view-wallet').classList.toggle('hidden', t !== 'wallet');
            document.getElementById('nav-trip').className = t === 'trip' ? 'nav-active flex flex-col items-center gap-1' : 'nav-inactive flex flex-col items-center gap-1';
            document.getElementById('nav-wallet').className = t === 'wallet' ? 'nav-active flex flex-col items-center gap-1' : 'nav-inactive flex flex-col items-center gap-1';
        }

        function renderDayBar() {
            const bar = document.getElementById('day-scroller');
            bar.innerHTML = tripData.map((d, i) => `
                <button onclick="setDay(${i})" class="day-btn w-12 h-12 rounded-xl flex-shrink-0 flex flex-col items-center justify-center font-bold ${i === dayIdx ? 'active' : 'bg-white/10 text-white/40'}">
                    <span class="text-[8px]">D</span>
                    <span class="text-base">${d.d}</span>
                </button>
            `).join('');
            bar.scrollTo({ left: dayIdx * 50, behavior: 'smooth' });
        }

        function setDay(i) {
            dayIdx = i;
            renderDayBar();
            updateView();
        }

        function updateView() {
            const d = tripData[dayIdx];
            document.getElementById('ui-day-label').innerText = `Day ${d.d}`;
            document.getElementById('ui-day-title').innerText = d.t;
            
            // 預訂連結
            const linkDisplay = document.getElementById('booking-links');
            if(d.links && d.links.length > 0) {
                linkDisplay.innerHTML = d.links.map(l => `
                    <a href="${l.url}" target="_blank" class="${l.icon === 'fa-car' ? 'car-btn' : 'kkday-btn'}">
                        <i class="fa-solid ${l.icon}"></i> ${l.name}
                    </a>
                `).join('');
                linkDisplay.classList.remove('hidden');
            } else {
                linkDisplay.innerHTML = '';
            }

            // 交通方式
            document.getElementById('transport-display').innerHTML = `<span class="transport-tag"><i class="fa-solid fa-bus"></i> 建議交通：${d.trans}</span>`;
            
            // 行程列表
            document.getElementById('itinerary-list').innerHTML = d.s.map(item => `
                <div class="card flex items-center justify-between py-4">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-circle-check text-sky-200"></i>
                        <span class="font-bold text-slate-700 text-sm">${item}</span>
                    </div>
                    <button onclick="openMap('${item}')" class="w-10 h-10 bg-slate-50 rounded-xl text-sky-600 flex items-center justify-center">
                        <i class="fa-solid fa-map"></i>
                    </button>
                </div>
            `).join('');
            
            document.getElementById('expert-tips').innerHTML = d.tips;
        }

        function openMap(q) {
            window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(q + ' Sydney')}`, '_blank');
        }

        function saveExpense() {
            const name = document.getElementById('exp-name').value;
            const aud = parseFloat(document.getElementById('exp-aud').value);
            if(!name || isNaN(aud)) return;
            expenses.push({ id: Date.now(), name, aud, twd: Math.round(aud * rate) });
            localStorage.setItem('sydney_trip_data', JSON.stringify(expenses));
            document.getElementById('exp-name').value = '';
            document.getElementById('exp-aud').value = '';
            renderExpenses();
        }

        function deleteExpense(id) {
            expenses = expenses.filter(e => e.id !== id);
            localStorage.setItem('sydney_trip_data', JSON.stringify(expenses));
            renderExpenses();
        }

        function renderExpenses() {
            const list = document.getElementById('expense-list');
            let tAUD = 0, tTWD = 0;
            list.innerHTML = expenses.map(e => {
                tAUD += e.aud; tTWD += e.twd;
                return `
                    <div class="bg-white p-4 rounded-xl flex justify-between items-center border border-slate-50">
                        <div class="text-sm font-bold text-slate-700">${e.name}</div>
                        <div class="flex items-center gap-3">
                            <span class="text-sky-600 font-black">$ ${e.aud}</span>
                            <button onclick="deleteExpense(${e.id})" class="text-slate-200"><i class="fa-solid fa-xmark"></i></button>
                        </div>
                    </div>
                `;
            }).reverse().join('');
            document.getElementById('total-aud').innerText = `$ ${tAUD.toFixed(1)}`;
            document.getElementById('total-twd').innerText = `$ ${tTWD.toLocaleString()}`;
        }

        window.onload = init;
    </script>
</body>
</html>

